# üìä Netflix Data Analysis Project

![Project Logo](logo.png)  

## üéØ Objective  
This project aims to analyze Netflix's dataset using SQL to extract meaningful insights, solve business problems, and uncover patterns in content distribution.

## üìå Dataset  
The dataset consists of various attributes like show ID, type (Movie/TV Show), title, director, cast, country, date added, release year, rating, duration, listed genres, and description.

---

## üèÜ Business Problems & SQL Queries  

### 1Ô∏è‚É£ Count the number of Movies vs TV Shows  
```sql
SELECT type, COUNT(*) as num_of_content
FROM netflix
GROUP BY type;
2Ô∏è‚É£ Find the most common rating for movies and TV shows
sql
Copy
Edit
SELECT type, rating
FROM 
(
    SELECT type, rating, COUNT(*),
           RANK() OVER(PARTITION BY type ORDER BY COUNT(*) DESC) AS ranking
    FROM netflix
    GROUP BY 1, 2
) AS T1
WHERE ranking = 1;
3Ô∏è‚É£ List all movies released in a specific year (e.g., 2019)
sql
Copy
Edit
SELECT * 
FROM netflix
WHERE type = 'Movie' AND release_year = 2019;
4Ô∏è‚É£ Find the top 5 countries with the most content on Netflix
sql
Copy
Edit
SELECT DISTINCT TRIM(UNNEST(STRING_TO_ARRAY(country, ','))) AS new_country, 
       COUNT(show_id) AS total_content
FROM netflix
GROUP BY 1
ORDER BY 2 DESC
LIMIT 5;
5Ô∏è‚É£ Identify the longest movie
sql
Copy
Edit
SELECT * 
FROM 
(
    SELECT DISTINCT title AS Movie, 
           split_part(duration, ' ', 1)::numeric AS duration
    FROM netflix
    WHERE type = 'Movie'
)
WHERE duration = (SELECT MAX(split_part(duration, ' ', 1)::numeric) FROM netflix);
6Ô∏è‚É£ Find content added in the last 5 years
sql
Copy
Edit
SELECT *
FROM netflix
WHERE TO_DATE(date_added, 'Month DD, YYYY') >= CURRENT_DATE - INTERVAL '5 Years';
7Ô∏è‚É£ Find all the movies/TV shows by director 'Rajiv Chilaka'
sql
Copy
Edit
SELECT *
FROM netflix
WHERE director ILIKE '%Rajiv Chilaka%';
8Ô∏è‚É£ List all TV shows with more than 5 seasons
sql
Copy
Edit
SELECT *
FROM netflix
WHERE type = 'TV Show' AND SPLIT_PART(duration, ' ', 1)::numeric > 5;
9Ô∏è‚É£ Count the number of content items in each genre
sql
Copy
Edit
SELECT TRIM(UNNEST(STRING_TO_ARRAY(listed_in, ','))) AS genre, 
       COUNT(show_id) AS num_of_content
FROM netflix
GROUP BY 1
ORDER BY 1 DESC;
üîü Find each year and the average number of content added from India
sql
Copy
Edit
SELECT EXTRACT(YEAR FROM TO_DATE(date_added, 'Month DD, YYYY')) AS year_added,
       COUNT(show_id) AS total_content,
       COUNT(show_id) / (SELECT COUNT(DISTINCT EXTRACT(YEAR FROM TO_DATE(date_added, 'Month DD, YYYY'))) 
                         FROM netflix 
                         WHERE country ILIKE '%India%') AS avg_content
FROM netflix
WHERE country ILIKE '%India%'
GROUP BY year_added
ORDER BY year_added DESC;
üìå Additional Queries
üé¨ Find the top 10 actors who have appeared in the highest number of movies produced in India
sql
Copy
Edit
SELECT TRIM(UNNEST(STRING_TO_ARRAY(casts, ','))) AS actors, 
       COUNT(show_id) AS total_appearance
FROM netflix
WHERE country LIKE '%India%'
GROUP BY actors
ORDER BY 2 DESC
LIMIT 10;
üé≠ Categorize content based on the presence of keywords 'kill' and 'violence' in the description
sql
Copy
Edit
SELECT CASE 
           WHEN description ILIKE '%kill%' OR description ILIKE '%violence%' THEN 'Bad'
           ELSE 'Good'
       END AS Category,
       COUNT(show_id) AS total_content
FROM netflix
GROUP BY 1;
‚è≥ Find the longest-running TV shows in each genre (Top 10 by seasons)
sql
Copy
Edit
SELECT TRIM(UNNEST(STRING_TO_ARRAY(listed_in, ','))) AS genre,
       title AS TV_show_name,
       CONCAT(round(MAX(split_part(duration, ' ', 1)::numeric), 2), ' ', 'seasons')
FROM netflix
WHERE type = 'TV Show'
GROUP BY 1, 2
ORDER BY 3 DESC
LIMIT 10;
üì¢ Conclusion
This project helps in understanding content trends on Netflix, including the most popular genres, ratings, countries with the most content, longest-running shows, and patterns in content addition over the years.

‚úÖ SQL techniques used:

Aggregations (COUNT, MAX, AVG)
String functions (SPLIT_PART, TRIM, ILIKE)
Window functions (RANK() OVER())
Data filtering (WHERE, GROUP BY, ORDER BY)
üìå Future Enhancements:

Visualization using Tableau/Power BI
Integration with Python for deeper analysis
üöÄ Developed by: [Your Name]
üìß Contact: [Your Email]
