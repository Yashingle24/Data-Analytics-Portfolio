#Netflix SQL Data Analysis

![Netflix Logo](logo.png)  

## üìå Objective  
This project aims to analyze Netflix's dataset to gain insights into content trends, audience preferences, and business strategies using SQL queries.

## üìä Business Problems & SQL Solutions  

### 1Ô∏è‚É£ Count the Number of Movies vs TV Shows  
```sql
SELECT type, COUNT(*) as num_of_content
FROM netflix
GROUP BY type;
```

2Ô∏è‚É£ Find the Most Common Rating for Movies and TV Shows
```sql
SELECT type, rating
FROM (
    SELECT type, rating, COUNT(*),
           RANK() OVER(PARTITION BY type ORDER BY COUNT(*) DESC) AS ranking
    FROM netflix
    GROUP BY 1, 2
) AS T1
WHERE ranking = 1;
```

3Ô∏è‚É£ List All Movies Released in a Specific Year (e.g., 2019)
```sql
SELECT * 
FROM netflix
WHERE type = 'Movie' AND release_year = 2019;
```

4Ô∏è‚É£ Find the Top 5 Countries with the Most Content
```sql
SELECT DISTINCT TRIM(UNNEST(STRING_TO_ARRAY(country, ','))) AS new_country, COUNT(show_id) AS total_content
FROM netflix
GROUP BY 1
ORDER BY 2 DESC
LIMIT 5;
```

5Ô∏è‚É£ Identify the Longest Movie
```sql
SELECT * 
FROM (
    SELECT DISTINCT title AS Movie, 
           split_part(duration, ' ', 1)::numeric AS duration
    FROM netflix
    WHERE type = 'Movie'
) 
WHERE duration = (SELECT MAX(split_part(duration, ' ', 1)::numeric) FROM netflix);
```

6Ô∏è‚É£ Find Content Added in the Last 5 Years
```sql
SELECT * 
FROM netflix
WHERE TO_DATE(date_added, 'Month DD, YYYY') >= CURRENT_DATE - INTERVAL '5 Years';
```

7Ô∏è‚É£ Find All Movies/TV Shows by Director 'Rajiv Chilaka'
```sql
SELECT * FROM netflix
WHERE director ILIKE '%Rajiv Chilaka%';
```

8Ô∏è‚É£ List All TV Shows with More than 5 Seasons
```sql
SELECT * FROM netflix
WHERE type = 'TV Show' AND SPLIT_PART(duration, ' ', 1)::numeric > 5;
```

9Ô∏è‚É£ Count the Number of Content Items in Each Genre
```sql
SELECT TRIM(UNNEST(STRING_TO_ARRAY(listed_in, ','))) AS genre, COUNT(show_id) AS num_of_content
FROM netflix
GROUP BY 1
ORDER BY 1 DESC;
```

üîü Find the Average Number of Content Added from India Each Year
```sql
SELECT  
    EXTRACT(YEAR FROM TO_DATE(date_added, 'Month DD, YYYY')) AS year_added,
    COUNT(show_id) AS total_content,
    COUNT(show_id) / (SELECT COUNT(DISTINCT EXTRACT(YEAR FROM TO_DATE(date_added, 'Month DD, YYYY'))) 
                      FROM netflix 
                      WHERE country ILIKE '%India%') AS avg_content
FROM netflix
WHERE country ILIKE '%India%'
GROUP BY year_added
ORDER BY year_added DESC;
```

üèÜ Additional Insights

‚úÖ Top 5 Directors with the Most Content in India

```sql
SELECT director, COUNT(show_id) AS total_content
FROM netflix
WHERE country ILIKE '%India%' AND director IS NOT NULL
GROUP BY 1
ORDER BY 2 DESC
LIMIT 5;
```

‚úÖ Top 10 Actors Who Appeared in Most Indian Movies

```sql
SELECT TRIM(UNNEST(STRING_TO_ARRAY(casts, ','))) AS actors, COUNT(show_id) AS total_appearance
FROM netflix
WHERE country LIKE '%India%'
GROUP BY actors
ORDER BY 2 DESC
LIMIT 10;
```

‚úÖ Categorizing Content as 'Good' or 'Bad' Based on Keywords

```sql
SELECT CASE 
       WHEN description ILIKE '%kill%' OR description ILIKE '%violence%' THEN 'Bad'
       ELSE 'Good'
       END AS Category,
       COUNT(show_id) AS total_content
FROM netflix
GROUP BY 1;
```

üìå Conclusion
This SQL project provides valuable insights into Netflix content, helping businesses understand viewing trends, popular genres, and content distribution across regions. üöÄ
